local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")

-- Create ScreenGui
local ScreenGui = Instance.new("ScreenGui")
local MainFrame = Instance.new("Frame")
local Sections = Instance.new("Frame")
local SpeedSection = Instance.new("Frame")
local TextBox = Instance.new("TextBox")
local SetButton = Instance.new("TextButton")
local MinimizeButton = Instance.new("TextButton")
local MinimizedFrame = Instance.new("Frame")
local Logo = Instance.new("TextLabel")
local UICorner = Instance.new("UICorner")
local UIGradient = Instance.new("UIGradient")
local UIStroke = Instance.new("UIStroke")

ScreenGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")
ScreenGui.ResetOnSpawn = false

-- Setup main frame
MainFrame.Name = "MainFrame"
MainFrame.Size = UDim2.new(0, 300, 0, 400)
MainFrame.Position = UDim2.new(0.5, -150, 0.5, -200)
MainFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
MainFrame.BorderSizePixel = 0
MainFrame.Parent = ScreenGui

-- Add corner radius
UICorner:Clone().Parent = MainFrame

-- Add glow effect
UIStroke.Color = Color3.fromRGB(0, 170, 255)
UIStroke.Thickness = 2
UIStroke.Parent = MainFrame

-- Setup sections container
Sections.Name = "Sections"
Sections.Size = UDim2.new(1, -20, 1, -60)
Sections.Position = UDim2.new(0, 10, 0, 50)
Sections.BackgroundTransparency = 1
Sections.Parent = MainFrame

-- Setup speed section
SpeedSection.Name = "SpeedSection"
SpeedSection.Size = UDim2.new(1, 0, 0, 100)
SpeedSection.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
SpeedSection.Parent = Sections
UICorner:Clone().Parent = SpeedSection

-- Setup text input box
TextBox.Size = UDim2.new(0.8, 0, 0.3, 0)
TextBox.Position = UDim2.new(0.1, 0, 0.2, 0)
TextBox.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
TextBox.PlaceholderText = "Type speed (0-500)"
TextBox.TextColor3 = Color3.fromRGB(255, 255, 255)
TextBox.Text = ""
TextBox.Parent = SpeedSection
UICorner:Clone().Parent = TextBox

-- Setup set button
SetButton.Size = UDim2.new(0.5, 0, 0.3, 0)
SetButton.Position = UDim2.new(0.25, 0, 0.6, 0)
SetButton.BackgroundColor3 = Color3.fromRGB(0, 170, 255)
SetButton.Text = "Set Speed"
SetButton.TextColor3 = Color3.fromRGB(255, 255, 255)
SetButton.Parent = SpeedSection
UICorner:Clone().Parent = SetButton

-- Setup minimize button
MinimizeButton.Size = UDim2.new(0, 30, 0, 30)
MinimizeButton.Position = UDim2.new(1, -40, 0, 10)
MinimizeButton.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
MinimizeButton.Text = "âˆ’"
MinimizeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
MinimizeButton.TextSize = 20
MinimizeButton.Parent = MainFrame
UICorner:Clone().Parent = MinimizeButton

-- Setup minimized frame (initially hidden)
MinimizedFrame.Size = UDim2.new(0, 50, 0, 50)
MinimizedFrame.Position = MainFrame.Position
MinimizedFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
MinimizedFrame.Visible = false
MinimizedFrame.Parent = ScreenGui
UICorner:Clone().Parent = MinimizedFrame

-- Setup logo
Logo.Size = UDim2.new(1, 0, 1, 0)
Logo.BackgroundTransparency = 1
Logo.Text = "ğŸš"
Logo.TextSize = 30
Logo.Parent = MinimizedFrame

-- Dragging functionality for both PC and mobile
local function enableDragging(frame)
    local dragging = false
    local dragInput
    local dragStart
    local startPos
    
    local function updateInput(input)
        local delta = input.Position - dragStart
        local position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X,
            startPos.Y.Scale, startPos.Y.Offset + delta.Y)
        
        local tweenInfo = TweenInfo.new(0.1, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
        TweenService:Create(frame, tweenInfo, {Position = position}):Play()
    end
    
    frame.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or
           input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            dragStart = input.Position
            startPos = frame.Position
        end
    end)
    
    frame.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or
           input.UserInputType == Enum.UserInputType.Touch then
            dragging = false
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or
                        input.UserInputType == Enum.UserInputType.Touch) then
            updateInput(input)
        end
    end)
end

enableDragging(MainFrame)
enableDragging(MinimizedFrame)

-- Minimize/Maximize functionality
local function toggleMinimize()
    local mainTweenInfo = TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
    
    if MainFrame.Visible then
        -- Minimize
        MinimizedFrame.Position = MainFrame.Position
        MinimizedFrame.Visible = true
        TweenService:Create(MainFrame, mainTweenInfo, {Size = UDim2.new(0, 0, 0, 0)}):Play()
        wait(0.3)
        MainFrame.Visible = false
    else
        -- Maximize
        MainFrame.Size = UDim2.new(0, 0, 0, 0)
        MainFrame.Position = MinimizedFrame.Position
        MainFrame.Visible = true
        TweenService:Create(MainFrame, mainTweenInfo, {Size = UDim2.new(0, 300, 0, 400)}):Play()
        wait(0.3)
        MinimizedFrame.Visible = false
    end
end

MinimizeButton.MouseButton1Click:Connect(toggleMinimize)
Logo.MouseButton1Click:Connect(toggleMinimize)

-- Speed changing functionality
SetButton.MouseButton1Click:Connect(function()
    local speed = tonumber(TextBox.Text)
    if speed and speed >= 0 and speed <= 500 then
        local player = game.Players.LocalPlayer
        local character = player.Character or player.CharacterAdded:Wait()
        local humanoid = character:WaitForChild("Humanoid")
        
        -- Smooth transition for speed change
        local tweenInfo = TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
        TweenService:Create(humanoid, tweenInfo, {WalkSpeed = speed}):Play()
    end
end)

-- Add pulsing glow effect
spawn(function()
    while wait(0.1) do
        local tweenInfo = TweenInfo.new(1, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut, -1, true)
        TweenService:Create(UIStroke, tweenInfo, {Transparency = 0.5}):Play()
    end
end)
