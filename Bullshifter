local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local Player = Players.LocalPlayer

-- GUI Creation
local ScreenGui = Instance.new("ScreenGui")
local MainFrame = Instance.new("Frame")
local Title = Instance.new("TextLabel") 
local PlayerInput = Instance.new("TextBox")
local FlingButton = Instance.new("TextButton")
local UICorner = Instance.new("UICorner")
local UIGradient = Instance.new("UIGradient")
local NeonEffect = Instance.new("Frame")

ScreenGui.Parent = Player:WaitForChild("PlayerGui")
ScreenGui.ResetOnSpawn = false

MainFrame.Name = "MainFrame"
MainFrame.Parent = ScreenGui
MainFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
MainFrame.Position = UDim2.new(0.5, -150, 0.5, -100)
MainFrame.Size = UDim2.new(0, 300, 0, 200)
MainFrame.Active = true
MainFrame.Draggable = true

Title.Name = "Title"
Title.Parent = MainFrame
Title.BackgroundTransparency = 1
Title.Position = UDim2.new(0, 0, 0, 10)
Title.Size = UDim2.new(1, 0, 0, 30)
Title.Font = Enum.Font.GothamBold
Title.Text = "Ultimate Fling"
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.TextSize = 24

PlayerInput.Name = "PlayerInput"
PlayerInput.Parent = MainFrame
PlayerInput.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
PlayerInput.Position = UDim2.new(0.1, 0, 0.3, 0)
PlayerInput.Size = UDim2.new(0.8, 0, 0, 40)
PlayerInput.Font = Enum.Font.Gotham
PlayerInput.PlaceholderText = "Enter Player Name"
PlayerInput.Text = ""
PlayerInput.TextColor3 = Color3.fromRGB(255, 255, 255)
PlayerInput.TextSize = 16

FlingButton.Name = "FlingButton"
FlingButton.Parent = MainFrame
FlingButton.BackgroundColor3 = Color3.fromRGB(255, 75, 75)
FlingButton.Position = UDim2.new(0.1, 0, 0.6, 0)
FlingButton.Size = UDim2.new(0.8, 0, 0, 50)
FlingButton.Font = Enum.Font.GothamBold
FlingButton.Text = "FLING!"
FlingButton.TextColor3 = Color3.fromRGB(255, 255, 255)
FlingButton.TextSize = 20

-- Apply rounded corners
local corners = {MainFrame, PlayerInput, FlingButton}
for _, obj in pairs(corners) do
   local corner = Instance.new("UICorner")
   corner.CornerRadius = UDim.new(0, 8)
   corner.Parent = obj
end

-- Neon effect
NeonEffect.Name = "NeonEffect"
NeonEffect.Parent = MainFrame
NeonEffect.BackgroundColor3 = Color3.fromRGB(255, 75, 75)
NeonEffect.BackgroundTransparency = 0.8
NeonEffect.BorderSizePixel = 0
NeonEffect.Size = UDim2.new(1, 0, 1, 0)
NeonEffect.ZIndex = -1

UIGradient.Color = ColorSequence.new({
   ColorSequenceKeypoint.new(0, Color3.fromRGB(255, 75, 75)),
   ColorSequenceKeypoint.new(1, Color3.fromRGB(255, 150, 150))
})
UIGradient.Parent = NeonEffect

-- Animate neon effect
local function animateNeon()
   local tweenInfo = TweenInfo.new(2, Enum.EasingStyle.Linear, Enum.EasingDirection.Out, -1)
   local tween = TweenService:Create(NeonEffect, tweenInfo, {BackgroundTransparency = 0.6})
   tween:Play()
end
animateNeon()

-- Enhanced fling functionality
getgenv().OldPos = nil
getgenv().FPDH = workspace.FallenPartsDestroyHeight

local function GetPlayer(Name)
   Name = Name:lower()
   for _, x in next, Players:GetPlayers() do
       if x ~= Player and (x.Name:lower():match("^" .. Name) or x.DisplayName:lower():match("^" .. Name)) then
           return x
       end
   end
   return nil
end

local function Notify(title, text, duration)
   game:GetService("StarterGui"):SetCore("SendNotification", {
       Title = title,
       Text = text,
       Duration = duration
   })
end

local function EnhancedFling(TargetPlayer)
   local Character = Player.Character
   local Humanoid = Character and Character:FindFirstChildOfClass("Humanoid")
   local RootPart = Humanoid and Humanoid.RootPart

   local TCharacter = TargetPlayer.Character
   local THumanoid = TCharacter and TCharacter:FindFirstChildOfClass("Humanoid")
   local TRootPart = THumanoid and THumanoid.RootPart
   local THead = TCharacter and TCharacter:FindFirstChild("Head")

   if not Character or not Humanoid or not RootPart then
       return Notify("Error", "Your character is missing parts", 3)
   end

   if not TCharacter or not THumanoid or not TRootPart then
       return Notify("Error", "Target is missing parts", 3)
   end

   -- Store original position
   getgenv().OldPos = RootPart.CFrame

   -- Prepare character for flinging
   workspace.FallenPartsDestroyHeight = math.huge / math.huge
   Humanoid:SetStateEnabled(Enum.HumanoidStateType.Seated, false)
   
   -- Create fling force
   local BV = Instance.new("BodyVelocity")
   BV.Name = "FlingForce"
   BV.Parent = RootPart
   BV.Velocity = Vector3.new(9999999, 9999999, 9999999)
   BV.MaxForce = Vector3.new(math.huge, math.huge, math.huge)

   -- Fling loop
   local startTime = tick()
   local flingConnection = RunService.Heartbeat:Connect(function()
       if not Character or not TCharacter or tick() - startTime > 5 then
           flingConnection:Disconnect()
           return
       end

       local targetPos = TRootPart.Position
       RootPart.CFrame = CFrame.new(targetPos) * CFrame.new(0, 0, 0)
       RootPart.Velocity = Vector3.new(9999999, 9999999, 9999999)
       RootPart.RotVelocity = Vector3.new(9999999, 9999999, 9999999)
   end)

   -- Cleanup after 5 seconds
   task.delay(5, function()
       if BV then BV:Destroy() end
       if Character and RootPart then
           Humanoid:SetStateEnabled(Enum.HumanoidStateType.Seated, true)
           workspace.FallenPartsDestroyHeight = getgenv().FPDH
           
           -- Reset position
           RootPart.CFrame = getgenv().OldPos
           RootPart.Velocity = Vector3.new(0, 0, 0)
           RootPart.RotVelocity = Vector3.new(0, 0, 0)
       end
   end)
end

-- Button effects
FlingButton.MouseEnter:Connect(function()
   TweenService:Create(FlingButton, TweenInfo.new(0.3), {
       BackgroundColor3 = Color3.fromRGB(255, 100, 100)
   }):Play()
end)

FlingButton.MouseLeave:Connect(function()
   TweenService:Create(FlingButton, TweenInfo.new(0.3), {
       BackgroundColor3 = Color3.fromRGB(255, 75, 75)
   }):Play()
end)

-- Connect fling function
FlingButton.MouseButton1Click:Connect(function()
   local targetName = PlayerInput.Text
   local targetPlayer = GetPlayer(targetName)
   
   if targetPlayer then
       EnhancedFling(targetPlayer)
   else
       Notify("Error", "Player not found", 3)
   end
end)
