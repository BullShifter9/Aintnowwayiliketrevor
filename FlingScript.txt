local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService") 
local RunService = game:GetService("RunService")
local HttpService = game:GetService("HttpService")
local Player = Players.LocalPlayer

-- Themes
local Themes = {
   Default = {
       primary = Color3.fromRGB(255, 75, 75),
       secondary = Color3.fromRGB(255, 100, 100),
       background = Color3.fromRGB(25, 25, 35),
       text = Color3.fromRGB(255, 255, 255)
   },
   Ocean = {
       primary = Color3.fromRGB(0, 132, 255),
       secondary = Color3.fromRGB(45, 156, 255), 
       background = Color3.fromRGB(20, 30, 40),
       text = Color3.fromRGB(255, 255, 255)
   },
   Forest = {
       primary = Color3.fromRGB(34, 197, 94),
       secondary = Color3.fromRGB(54, 217, 114),
       background = Color3.fromRGB(25, 35, 25),
       text = Color3.fromRGB(255, 255, 255)
   },
   Royal = {
       primary = Color3.fromRGB(147, 51, 234),
       secondary = Color3.fromRGB(167, 71, 254),
       background = Color3.fromRGB(30, 25, 35),
       text = Color3.fromRGB(255, 255, 255)
   },
   Sunset = {
       primary = Color3.fromRGB(245, 158, 11),
       secondary = Color3.fromRGB(255, 178, 31),
       background = Color3.fromRGB(35, 25, 25),
       text = Color3.fromRGB(255, 255, 255)
   }
}

-- Welcome GUI
local WelcomeGui = Instance.new("ScreenGui")
local WelcomeFrame = Instance.new("Frame")
local WelcomeText = Instance.new("TextLabel")

WelcomeGui.Parent = Player:WaitForChild("PlayerGui")
WelcomeFrame.Size = UDim2.new(0, 300, 0, 100)
WelcomeFrame.Position = UDim2.new(0.5, -150, 0.4, -50)
WelcomeFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
WelcomeFrame.Parent = WelcomeGui

WelcomeText.Size = UDim2.new(1, 0, 1, 0)
WelcomeText.BackgroundTransparency = 1
WelcomeText.Text = "Ultimate Fling!ðŸ—£ï¸ðŸ—£ï¸"
WelcomeText.TextColor3 = Color3.fromRGB(255, 255, 255)
WelcomeText.TextSize = 24
WelcomeText.Font = Enum.Font.GothamBold
WelcomeText.Parent = WelcomeFrame

local WelcomeCorner = Instance.new("UICorner")
WelcomeCorner.CornerRadius = UDim.new(0, 8)
WelcomeCorner.Parent = WelcomeFrame

-- Main GUI
local ScreenGui = Instance.new("ScreenGui")
local MainFrame = Instance.new("Frame")
local Title = Instance.new("TextLabel")
local PlayerInput = Instance.new("TextBox")
local FlingButton = Instance.new("TextButton")
local UICorner = Instance.new("UICorner")
local UIGradient = Instance.new("UIGradient")
local NeonEffect = Instance.new("Frame")

ScreenGui.Parent = Player:WaitForChild("PlayerGui")
ScreenGui.ResetOnSpawn = false

-- Add blur effect
local blur = Instance.new("BlurEffect")
blur.Size = 10
blur.Parent = game:GetService("Lighting")

MainFrame.Name = "MainFrame"
MainFrame.Parent = ScreenGui
MainFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
MainFrame.Position = UDim2.new(0.5, -150, 0.5, -100)
MainFrame.Size = UDim2.new(0, 300, 0, 200)
MainFrame.Active = true
MainFrame.Draggable = true

-- Background gradient
local BackgroundGradient = Instance.new("UIGradient")
BackgroundGradient.Color = ColorSequence.new({
   ColorSequenceKeypoint.new(0, Color3.fromRGB(30, 30, 35)),
   ColorSequenceKeypoint.new(1, Color3.fromRGB(45, 45, 50))
})
BackgroundGradient.Rotation = 45
BackgroundGradient.Parent = MainFrame

-- Stroke effect
local UIStroke = Instance.new("UIStroke")
UIStroke.Color = Themes.Default.primary
UIStroke.Thickness = 2
UIStroke.Parent = MainFrame

-- Theme Frame
local ThemeFrame = Instance.new("Frame")
ThemeFrame.Name = "ThemeFrame"
ThemeFrame.Parent = MainFrame
ThemeFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
ThemeFrame.Position = UDim2.new(1.1, 0, 0, 0)
ThemeFrame.Size = UDim2.new(0, 150, 1, 0)
ThemeFrame.Visible = false

local ThemeList = Instance.new("ScrollingFrame")
ThemeList.Name = "ThemeList"
ThemeList.Parent = ThemeFrame
ThemeList.BackgroundTransparency = 1
ThemeList.Position = UDim2.new(0, 5, 0, 5)
ThemeList.Size = UDim2.new(1, -10, 1, -10)
ThemeList.ScrollBarThickness = 4

local UIListLayout = Instance.new("UIListLayout")
UIListLayout.Parent = ThemeList
UIListLayout.Padding = UDim.new(0, 5)

-- Theme Button
local ThemeButton = Instance.new("TextButton")
ThemeButton.Parent = MainFrame
ThemeButton.Position = UDim2.new(0, 5, 0, 5)
ThemeButton.Size = UDim2.new(0, 30, 0, 30)
ThemeButton.BackgroundColor3 = Themes.Default.primary
ThemeButton.Text = "ðŸŽ¨"
ThemeButton.TextSize = 16
ThemeButton.Font = Enum.Font.GothamBold

local ThemeCorner = Instance.new("UICorner")
ThemeCorner.CornerRadius = UDim.new(0, 4)
ThemeCorner.Parent = ThemeButton

-- Minimize Button
local MinimizeButton = Instance.new("TextButton")
MinimizeButton.Name = "MinimizeButton"
MinimizeButton.Parent = MainFrame
MinimizeButton.BackgroundColor3 = Color3.fromRGB(255, 75, 75)
MinimizeButton.Position = UDim2.new(1, -30, 0, 5)
MinimizeButton.Size = UDim2.new(0, 25, 0, 25)
MinimizeButton.Font = Enum.Font.GothamBold
MinimizeButton.Text = "-"
MinimizeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
MinimizeButton.TextSize = 20

local MinimizeCorner = Instance.new("UICorner")
MinimizeCorner.CornerRadius = UDim.new(0, 4)
MinimizeCorner.Parent = MinimizeButton

-- Glow Effects
local OuterGlow = Instance.new("Frame")
OuterGlow.Name = "OuterGlow"
OuterGlow.BackgroundColor3 = Themes.Default.primary
OuterGlow.BackgroundTransparency = 0.5
OuterGlow.BorderSizePixel = 0
OuterGlow.Position = UDim2.new(0, -5, 0, -5)
OuterGlow.Size = UDim2.new(1, 10, 1, 10)
OuterGlow.ZIndex = -2
OuterGlow.Parent = MainFrame

local InnerGlow = Instance.new("Frame")
InnerGlow.Name = "InnerGlow"
InnerGlow.BackgroundColor3 = Themes.Default.primary
InnerGlow.BackgroundTransparency = 0.7
InnerGlow.BorderSizePixel = 0
InnerGlow.Size = UDim2.new(1, 0, 1, 0)
InnerGlow.ZIndex = -1
InnerGlow.Parent = MainFrame

local OuterGlowCorner = Instance.new("UICorner")
OuterGlowCorner.CornerRadius = UDim.new(0, 12)
OuterGlowCorner.Parent = OuterGlow

local InnerGlowCorner = Instance.new("UICorner")
InnerGlowCorner.CornerRadius = UDim.new(0, 8)
InnerGlowCorner.Parent = InnerGlow

-- Main Elements
Title.Name = "Title"
Title.Parent = MainFrame
Title.BackgroundTransparency = 1
Title.Position = UDim2.new(0, 0, 0, 10)
Title.Size = UDim2.new(1, 0, 0, 30)
Title.Font = Enum.Font.GothamBold
Title.Text = "Ultimate Fling by Azzakirms"
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.TextSize = 24

PlayerInput.Name = "PlayerInput"
PlayerInput.Parent = MainFrame
PlayerInput.BackgroundColor3 = Color3.fromRGB(35, 35, 40)
PlayerInput.Position = UDim2.new(0.1, 0, 0.3, 0)
PlayerInput.Size = UDim2.new(0.8, 0, 0, 40)
PlayerInput.Font = Enum.Font.Gotham
PlayerInput.PlaceholderText = "Enter Player Name"
PlayerInput.Text = ""
PlayerInput.TextColor3 = Color3.fromRGB(255, 255, 255)
PlayerInput.TextSize = 16

local InputStroke = Instance.new("UIStroke")
InputStroke.Color = Themes.Default.primary
InputStroke.Thickness = 1
InputStroke.Parent = PlayerInput

FlingButton.Name = "FlingButton"
FlingButton.Parent = MainFrame
FlingButton.BackgroundColor3 = Themes.Default.primary
FlingButton.Position = UDim2.new(0.1, 0, 0.6, 0)
FlingButton.Size = UDim2.new(0.8, 0, 0, 50)
FlingButton.Font = Enum.Font.GothamBold
FlingButton.Text = "FLING!"
FlingButton.TextColor3 = Color3.fromRGB(255, 255, 255)
FlingButton.TextSize = 20

-- Button Gradient
local ButtonGradient = Instance.new("UIGradient")
ButtonGradient.Color = ColorSequence.new({
   ColorSequenceKeypoint.new(0, Themes.Default.primary),
   ColorSequenceKeypoint.new(1, Themes.Default.secondary)
})
ButtonGradient.Parent = FlingButton

-- Corners
local corners = {MainFrame, PlayerInput, FlingButton, ThemeFrame}
for _, obj in pairs(corners) do
   local corner = Instance.new("UICorner")
   corner.CornerRadius = UDim.new(0, 8)
   corner.Parent = obj
end

NeonEffect.Name = "NeonEffect"
NeonEffect.Parent = MainFrame
NeonEffect.BackgroundColor3 = Themes.Default.primary
NeonEffect.BackgroundTransparency = 0.8
NeonEffect.BorderSizePixel = 0
NeonEffect.Size = UDim2.new(1, 0, 1, 0)
NeonEffect.ZIndex = -1

-- Particle Effect
local ParticleEmitter = Instance.new("ParticleEmitter")
ParticleEmitter.Color = ColorSequence.new(Themes.Default.primary)
ParticleEmitter.Transparency = NumberSequence.new({
   NumberSequenceKeypoint.new(0, 0.8),
   NumberSequenceKeypoint.new(1, 1)
})
ParticleEmitter.Size = NumberSequence.new(0.1)
ParticleEmitter.Lifetime = NumberRange.new(1, 2)
ParticleEmitter.Rate = 50
ParticleEmitter.Speed = NumberRange.new(1, 3)
ParticleEmitter.Parent = NeonEffect

-- Theme Function
local function ApplyTheme(theme)
   local colors = Themes[theme]
   MainFrame.BackgroundColor3 = colors.background
   FlingButton.BackgroundColor3 = colors.primary
   UIStroke.Color = colors.primary
   InputStroke.Color = colors.primary
   OuterGlow.BackgroundColor3 = colors.primary
   InnerGlow.BackgroundColor3 = colors.primary
   NeonEffect.BackgroundColor3 = colors.primary
   ParticleEmitter.Color = ColorSequence.new(colors.primary)
   
   ButtonGradient.Color = ColorSequence.new({
       ColorSequenceKeypoint.new(0, colors.primary),
       ColorSequenceKeypoint.new(1, colors.secondary)
   })
end

-- Create Theme Buttons
for themeName, _ in pairs(Themes) do
   local button = Instance.new("TextButton")
   button.Size = UDim2.new(1, -10, 0, 30)
   button.BackgroundColor3 = Themes[themeName].primary
   button.Text = themeName
   button.TextColor3 = Color3.fromRGB(255, 255, 255)
   button.Font = Enum.Font.GothamBold
   button.Parent = ThemeList
   
   local corner = Instance.new("UICorner")
   corner.CornerRadius = UDim.new(0, 4)
   corner.Parent = button
   
   button.MouseButton1Click:Connect(function()
       ApplyTheme(themeName)
       ThemeFrame.Visible = false
   end)
end

-- Minimize functionality
local minimized = false
local originalSize = MainFrame.Size
local minimizedSize = UDim2.new(0, 300, 0, 40)

MinimizeButton.MouseButton1Click:Connect(function()
   minimized = not minimized
   local targetSize = minimized and minimizedSize or originalSize
   local buttonText = minimized and "+" or "-"
   
   TweenService:Create(MainFrame, TweenInfo.new(0.3), {Size = targetSize}):Play()
   MinimizeButton.Text = buttonText
   
   PlayerInput.Visible = not minimized
   FlingButton.Visible = not minimized
   NeonEffect.Visible = not minimized
   OuterGlow.Visible = not minimized
   InnerGlow.Visible = not minimized
end)

-- Theme toggle
ThemeButton.MouseButton1Click:Connect(function()
   ThemeFrame.Visible = not ThemeFrame.Visible
end)

-- Animations
local function animateGlow()
   local outerTween = TweenService:Create(OuterGlow, TweenInfo.new(2, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut, -1, true), {
       BackgroundTransparency = 0.8,
       Size = UDim2.new(1, 20, 1, 20),
       Position = UDim2.new(0, -10, 0, -10)
   })
   
   local innerTween = TweenService:Create(InnerGlow, TweenInfo.new(1.5, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut, -1, true), {
       BackgroundTransparency = 0.9
   })
   
   outerTween:Play()
   innerTween:Play()
end

local function animateNeon()
   local tweenInfo = TweenInfo.new(2, Enum.EasingStyle.Linear, Enum.EasingDirection.Out, -1)
   local tween = TweenService:Create(NeonEffect, tweenInfo, {BackgroundTransparency = 0.6})
   tween:Play()
end

local function floatingAnimation()
   local tweenInfo = TweenInfo.new(2, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut, -1, true)
   local tween = TweenService:Create(MainFrame, tweenInfo, {
       Position = MainFrame.Position + UDim2.new(0, 0, 0, 5)
   })
   tween:Play()
end

getgenv().OldPos = nil
getgenv().FPDH = workspace.FallenPartsDestroyHeight

local function GetPlayer(Name)
   Name = Name:lower()
   for _, x in next, Players:GetPlayers() do
       if x ~= Player and (x.Name:lower():match("^" .. Name) or x.DisplayName:lower():match("^" .. Name)) then
           return x
       end
   end
   return nil
end

local function Notify(title, text, duration)
   game:GetService("StarterGui"):SetCore("SendNotification", {
       Title = title,
       Text = text,
       Duration = duration
   })
end

local function EnhancedFling(TargetPlayer)
   local Character = Player.Character
   local Humanoid = Character and Character:FindFirstChildOfClass("Humanoid")
   local RootPart = Humanoid and Humanoid.RootPart
   local TCharacter = TargetPlayer.Character
   local THumanoid = TCharacter and TCharacter:FindFirstChildOfClass("Humanoid")
   local TRootPart = THumanoid and THumanoid.RootPart
   local THead = TCharacter and TCharacter:FindFirstChild("Head")

   if not Character or not Humanoid or not RootPart then
       return Notify("Error", "Your character is missing parts", 3)
   end
   if not TCharacter or not THumanoid or not TRootPart then
       return Notify("Error", "Target is missing parts", 3)
   end

   getgenv().OldPos = RootPart.CFrame
   workspace.FallenPartsDestroyHeight = math.huge / math.huge
   Humanoid:SetStateEnabled(Enum.HumanoidStateType.Seated, false)
   
   local BV = Instance.new("BodyVelocity")
   BV.Name = "FlingForce"
   BV.Parent = RootPart
   BV.Velocity = Vector3.new(9999999, 9999999, 9999999)
   BV.MaxForce = Vector3.new(math.huge, math.huge, math.huge)

   local updateDelta = 0.1
   local lastUpdate = tick()
   local startTime = tick()

   local flingConnection = RunService.Heartbeat:Connect(function()
       if not Character or not TCharacter or tick() - startTime > 5 then
           flingConnection:Disconnect()
           return
       end
       
       if tick() - lastUpdate < updateDelta then return end
       lastUpdate = tick()

       local targetPos = TRootPart.Position
       RootPart.CFrame = CFrame.new(targetPos) * CFrame.new(0, 0, 0)
       RootPart.Velocity = Vector3.new(9999999, 9999999, 9999999)
       RootPart.RotVelocity = Vector3.new(9999999, 9999999, 9999999)
   end)

   task.delay(5, function()
       if BV then BV:Destroy() end
       if Character and RootPart then
           Humanoid:SetStateEnabled(Enum.HumanoidStateType.Seated, true)
           workspace.FallenPartsDestroyHeight = getgenv().FPDH
           
           RootPart.CFrame = getgenv().OldPos
           RootPart.Velocity = Vector3.new(0, 0, 0)
           RootPart.RotVelocity = Vector3.new(0, 0, 0)
       end
   end)
end

FlingButton.MouseButton1Click:Connect(function()
   local targetName = PlayerInput.Text
   local targetPlayer = GetPlayer(targetName)
   
   if targetPlayer then
       EnhancedFling(targetPlayer)
   else
       Notify("Error", "Player not found", 3)
   end
end)

ScreenGui.Enabled = false
task.wait(3)

TweenService:Create(WelcomeFrame, TweenInfo.new(0.5), {BackgroundTransparency = 1}):Play()
TweenService:Create(WelcomeText, TweenInfo.new(0.5), {TextTransparency = 1}):Play()

task.wait(0.5)
WelcomeGui:Destroy()
ScreenGui.Enabled = true

Notify("Script Executed", "Made by Azzakirms\nPlease Subscribe! For more!!", 5)

animateGlow()
animateNeon()
floatingAnimation()
